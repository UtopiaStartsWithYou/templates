// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/typescript-node

{
	"name": "REPLACE WITH YOUR PROJECT NAME - Devcontainer Arbitrary Text",

	"workspaceMount": "type=bind,source=${localWorkspaceFolder},target=/workspaces/${localWorkspaceFolderBasename},consistency=cached",
	"workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

	//-----------------------------------------------------------------------------------------------
	// direct image here,
	//-----------------------------------------------------------------------------------------------
	// "image": "mcr.microsoft.com/devcontainers/base:debian",

	//-----------------------------------------------------------------------------------------------
	// or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
	//-----------------------------------------------------------------------------------------------
	"build": {
		"dockerfile": "Dockerfile"
	},

	//----------------------------------------------------------------------------------
	// Features to add to the dev container. More info: https://containers.dev/features.
	//----------------------------------------------------------------------------------
	// "features": {},
	"features": {
		"ghcr.io/devcontainers/features/node:1": {
			"version": "lts"
		}
	},

	//-----------------------------------------------------------------------------------
	// Use 'forwardPorts' to make a list of ports inside the container available locally.
	//-----------------------------------------------------------------------------------
	"forwardPorts": [],
	"portsAttributes": {},

	//------------------------------------------------------------------------
	// Use 'postCreateCommand' to run commands after the container is created.
	//------------------------------------------------------------------------
	"postCreateCommand": [],
	"containerEnv": {},



	//--------------------------------------------------------------------
	// Mount directories for persistent Claude config and project settings
	//--------------------------------------------------------------------
	"mounts": [
		// ~/.bashrc and helpers
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/home/.bashrc,target=/home/vscode/.bashrc,consistency=cached",
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/home/.bashrc__vanilla,target=/home/vscode/.bashrc__vanilla,consistency=cached",
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/home/.bashrc__custom,target=/home/vscode/.bashrc__custom,consistency=cached",
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/home/.bashrc__claude_configs,target=/home/vscode/.bashrc__claude_configs,consistency=cached",
		
		// ~/.bash_history
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/home/.bash_history,target=/home/vscode/.bash_history,consistency=cached",

		// ---------------------------------------------------------------------------------------------------
		// <project>/.claude/mount/*   ->   ~/.claude   +   ~/.claude.json   +   ~/.claude.json.backup
		// ---------------------------------------------------------------------------------------------------
		"type=bind,source=${localWorkspaceFolder}/.claude/mount/home/(dot)claude,target=/home/vscode/.claude,consistency=cached",

		// ---------------------------------------------------------------------------------------------------
		// mount Godot binary
		// ---------------------------------------------------------------------------------------------------
		// "type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/godot-binary/Godot_v4.5-stable_linux.x86_64,target=/usr/local/bin/godot,consistency=cached",
		"type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/godot-binary/Godot_v4.5.1-stable_linux.x86_64,target=/usr/local/bin/godot,consistency=cached"

		// ---------------------------------------------------------------------------------------------------
		// MCP Servers
		// ---------------------------------------------------------------------------------------------------
		// "type=bind,source=${localWorkspaceFolder}/.devcontainer/mount/godot-mcp,target=/opt/godot-mcp,consistency=cached",
	],

	// Configure tool-specific properties.
	// "customizations": {},

	// No API key needed - Claude Code uses browser auth
	"customizations": {
		"vscode": {
			"extensions": [
				"Anthropic.claude-code",
				"ms-python.python",
				"SolarLiner.linux-themes",
				"johnnywong.quick-replace-in-selection",
				"shd101wyy.markdown-preview-enhanced",
				"geequlim.godot-tools"
			],
			"settings": {
				"workbench.colorTheme": "Ambiance [beta]",
				"workbench.colorCustomizations": {
					"tab.activeBackground": "#5f4a8186",
					"activityBar.inactiveForeground": "#6d7c87e1",
					"activityBar.background": "#384c896b",
					"statusBar.background": "#113d4b",
					"statusBarItem.remoteBackground": "#3db36e86"
				}
			}
		}
	}

}
